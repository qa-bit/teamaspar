{% trans_default_domain 'riders' %}

{% set r = rider %}

{% macro list_isset(r, field) %}
    {% if attribute(r, field) %}
        <li>
            <span class="title">{{ field | trans }}:</span>
            <span>{{ attribute(r, field) }}</span>
        </li>
    {% endif %}
{% endmacro %}

{% import _self as forms %}

{% extends "MotogpBundle:Default:base.html.twig" %}
{% block body %}
    {{ parent() }}

    {% if rider.medias is not null and rider.medias | length %}
        {% include "MotogpBundle:Default:Blocks/top-slider.html.twig" with {'gallery' : rider } %}
    {% endif %}

    <div class="smoke-background">
        <div class="white-background">
            <div class="w100 rider-description">
                <div id="{{ r.name | lower }}-{{ r.surname | lower }}">
                    <div class="row info">
                        <div class="col-xs-12 col-md-4">
                            <img class="rider-featured-image" src="{% path r.featuredMedia, 'big' %}" alt="" />
                        </div>
                        <div class="col-xs-12 col-md-8 rider-name">
                            <h5><b>{{ r.name }} {{ r.surname }} #{{ r.number }}</b></h5>
                            <ul>
                                <li>
                                    <span class="title">{{ 'birthDate' | trans }}:</span>
                                    <span>{{ r.birthDate | date('d/m/Y') }} - {{ r.birthPlace }} -  {{  r.country }} {{ 'age' | trans }}: {{ r.getAge() }} </span>
                                </li>
                                {{ forms.list_isset(r, 'firstRace') }}
                                {{ forms.list_isset(r, 'firstGrandPrix') }}
                                {{ forms.list_isset(r, 'firstVictory') }}
                                {{ forms.list_isset(r, 'lastVictory') }}
                                {{ forms.list_isset(r, 'firstPole') }}
                                {{ forms.list_isset(r, 'firstFastLap') }}
                                {{ forms.list_isset(r, 'firstPodium') }}
                                {{ forms.list_isset(r, 'victorys') }}
                                {{ forms.list_isset(r, 'podiums') }}
                                {{ forms.list_isset(r, 'poles') }}
                                {{ forms.list_isset(r, 'firstRace') }}
                                {{ forms.list_isset(r, 'fastLaps') }}
                                {{ forms.list_isset(r, 'bestGeneralResult') }}
                                {{ forms.list_isset(r, 'gpss') }}
                            </ul>
                        </div>

                        {% if r.records | length %}
                            <div class="row track-records">
                                <h5><b>{{ 'trackRecords' | trans }}</b></h5>

                                {%  for key, record in r.getGroupedRecords() %}
                                    {% if loop.index == 1 or (loop.index % 10  == 0)%}
                                        <div class="col-xs-12 col-md-6">
                                        <ul>
                                    {% endif %}
                                    <li><span class="title">{{ key }}:</span>
                                        {% for ri in record %}
                                            {{ ri.description }}<br>
                                        {% endfor %}
                                    </li>
                                    {% if (loop.index % 10  == 9) %}
                                        </ul></div>
                                    {% endif %}
                                {%  endfor %}

                            </div>
                        {% endif %}

                    </div>

                    {% if r.description or r.descriptionEN %}
                        <div class="row info rider-biografy">
                            <h5><b>{{ "biografy" | trans }}</b></h5>
                            <div>{{ r.description | raw }}</div>
                        </div>
                    {% endif %}
                </div></div>

        </div>
    </div>
    </div>
    {% set g = [] %}
    {% for gl in galleries %}
        {% for m in gl.medias %}
            {% if m.rider is not null and m.rider.id == r.id %}
                {% set g = g | merge([m]) %}
            {% endif %}
        {% endfor %}
    {% endfor %}

    {% if g | length %}
        {% include 'MotogpBundle:Default:Riders/rider-gallery.html.twig' with {'gallery' : g} %}
    {% endif %}

    {% include 'MotogpBundle:Default:footer.html.twig' %}
{% endblock %}